<!DOCTYPE HTML>
<html lang="en">

<head>
    <meta charset="utf-8">
    <title>lensluxe ecommerce website Dashboard</title>
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta property="og:title" content="">
    <meta property="og:type" content="">  
    <meta property="og:url" content="">
    <meta property="og:image" content="">
    <!-- Favicon -->
    <link rel="shortcut icon" type="image/x-icon" href="/admin_assets/imgs/theme/favicon.svg">
    <!-- Template CSS -->
    <link href="/admin_assets/css/main.css" rel="stylesheet" type="text/css" />
    <style>
        /* Add custom styles for active sidebar items */
        .menu-aside .menu-item.active a {
            background-color: #333;
        }

        .menu-aside .menu-item.active a .icon {
            color: #fff;
        }

        .menu-aside .menu-item.active a .text {
            color: #fff;
        }
    </style>
</head>

<body>
    <!-- Header -->
    <header class="main-header navbar">
        <div class="col-search">
            <!-- Search form can be added here if needed -->
        </div>
        <div class="col-nav">
            <!-- Logout button -->
            <a href="/admin/adminlogout" class="btn" style="background-color: #008178; color: white;">Logout</a>
        </div>
    </header>
    <!-- Sidebar -->
    <aside class="navbar-aside" id="offcanvas_aside">
        <div class="aside-top">
            <a href="index.html" class="brand-wrap">
                <img src="/admin_assets/imgs/theme/lensluxe.png" class="logo" alt="Evara Dashboard">
            </a>
            <div>
                <button class="btn btn-icon btn-aside-minimize"> <i class="text-muted material-icons md-menu_open"></i> </button>
            </div>
        </div>
        <nav>
            <ul class="menu-aside">
                <li class="menu-item">
                    <a class="menu-link" href="#" onclick="highlightMenuItem(this)"> <i class="icon material-icons md-home"></i>
                        <span class="text">Dashboard</span>
                    </a>
                </li>
                <!-- Customers link -->
                <li class="menu-item">
                    <a class="menu-link" href="/admin/customer" onclick="highlightMenuItem(this)">
                        <i class="icon material-icons md-people"></i>
                        <span class="text">Customers</span>
                    </a>
                </li>
                <!-- Categories link -->
                <li class="menu-item">
                    <a class="menu-link" href="/admin/category" onclick="highlightMenuItem(this)">
                        <i class="icon material-icons md-category"></i>
                        <span class="text">Categories</span>
                    </a>
                </li>
                <!-- Products link -->
                <li class="menu-item">
                    <a class="menu-link" href="/admin/product" onclick="highlightMenuItem(this)">
                        <i class="icon material-icons md-shopping_basket"></i>
                        <span class="text">Products</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a class="menu-link" href="/admin/order" onclick="highlightMenuItem(this)">
                        <i class="icon material-icons md-store"></i>
                        <span class="text">Order</span>
                    </a>
                </li>
                <li class="menu-item">
                    <a class="menu-link" href="/admin/offer" onclick="highlightMenuItem(this)">
                        <i class="icon material-icons md-local_offer"></i>
                        <span class="text">Offer</span>
                    </a>
                </li> 
                <li class="menu-item">
                    <a class="menu-link" href="/admin/coupon" onclick="highlightMenuItem(this)">
                        <i class="material-icons md-store"></i>

                        <span class="text">Coupon</span>
                    </a>
                </li>
            </ul>
        </nav>
    </aside>
    <!-- Main Content -->
    <main class="main-wrap">
        <section class="content-main">
          <div class="content-header">
            <div>
              <h2 class="content-title card-title">Order Details</h2>
            </div>
            <div>
              <a href="/admin/order" class="btn btn-light"><i class="material-icons md-arrow_back"></i> Back to Orders</a>
            </div>
          </div>
          
          <% orders.forEach(order => { %>
            <!-- Order Summary Card -->
            <div class="card mb-4">
              <div class="card-header">
                <h5>Order Summary</h5>
              </div>
              <div class="card-body">
                <div class="row">
                  <div class="col-md-6">
                    <p><strong>Order ID:</strong> <%= order.orderID %></p>
                    <p><strong>Order Date:</strong> <%= order.orderDate.toDateString() %></p>
                    <p><strong>Order Status:</strong> <span class="badge bg-info"><%= order.orderStatus %></span></p>
                  </div>
                  <div class="col-md-6">
                    <p><strong>Payment Method:</strong> <%= order.paymentMethod %></p>
                    <p><strong>Payment Status:</strong> <span class="badge bg-<%= order.paymentStatus === 'Success' ? 'success' : order.paymentStatus === 'Failed' ? 'danger' : 'warning' %>"><%= order.paymentStatus %></span></p>
                    <p><strong>Total Amount:</strong> <span class="text-success fw-bold">₹<%= order.billTotal.toFixed(2) %></span></p>
                  </div>
                </div>
                <hr>
                <div class="row">
                  <div class="col-md-6">
                    <h6>Shipping Address:</h6>
                    <% if (order.shippingAddress) { %>
                      <p><%= order.shippingAddress.street %><br>
                      <%= order.shippingAddress.city %>, <%= order.shippingAddress.state %><br>
                      <%= order.shippingAddress.country %> - <%= order.shippingAddress.postalCode %></p>
                    <% } %>
                  </div>
                  <div class="col-md-6">
                    <% if (order.couponCode && order.couponCode !== 'nil') { %>
                      <h6>Coupon Details:</h6>
                      <p><strong>Coupon Code:</strong> <%= order.couponCode %></p>
                      <p><strong>Coupon Name:</strong> <%= order.couponName %></p>
                      <p><strong>Discount:</strong> ₹<%= order.couponAmount.toFixed(2) %></p>
                    <% } %>
                  </div>
                </div>
              </div>
            </div>

            <!-- Order Items Card -->
            <div class="card">
              <div class="card-header">
                <h5>Order Items</h5>
              </div>
              <div class="card-body">
                <div class="table-responsive">
                  <table class="table table-hover">
                    <thead class="table-light">
                      <tr>
                        <th>Product Image</th>
                        <th>Product Name</th>
                        <th>Quantity</th>
                        <th>Unit Price</th>
                        <th>Total Price</th>
                        <th>Status</th>
                      </tr>
                    </thead>
                    <tbody>
                      <% order.items.forEach(item => { %>
                        <tr>
                          <td>
                            <% if (item.image && item.image.length > 0) { %>
                              <img src="/productimages/<%= item.image[0] %>" class="img-thumbnail" alt="<%= item.title %>"
                              style="width: 80px; height: auto;">
                            <% } %>
                          </td>
                          <td><strong><%= item.title %></strong></td>
                          <td><%= item.quantity %></td>
                          <td>₹<%= item.productPrice.toFixed(2) %></td>
                          <td>₹<%= item.price.toFixed(2) %></td>
                          <td><span class="badge bg-<%= item.Status === 'Delivered' ? 'success' : item.Status === 'Cancelled' ? 'danger' : item.Status === 'Returned' ? 'warning' : 'info' %>"><%= item.Status %></span></td>
                        </tr>
                      <% }); %>
                    </tbody>
                    <tfoot>
                      <tr>
                        <td colspan="4" class="text-end"><strong>Subtotal:</strong></td>
                        <td colspan="2"><strong>₹<%= order.items.reduce((sum, item) => sum + item.price, 0).toFixed(2) %></strong></td>
                      </tr>
                      <% if (order.couponAmount > 0) { %>
                        <tr>
                          <td colspan="4" class="text-end"><strong>Discount:</strong></td>
                          <td colspan="2" class="text-success"><strong>- ₹<%= order.couponAmount.toFixed(2) %></strong></td>
                        </tr>
                      <% } %>
                      <tr class="table-active">
                        <td colspan="4" class="text-end"><strong>Total Amount:</strong></td>
                        <td colspan="2"><strong class="text-success">₹<%= order.billTotal.toFixed(2) %></strong></td>
                      </tr>
                    </tfoot>
                  </table>
                </div>
              </div>
            </div>
          <% }); %>
        </section>
      </main>
  <!-- Footer -->
    <footer class="main-footer font-xs">
        <div class="row pb-30 pt-15">
            <div class="col-sm-6">
                <script>
                    document.write(new Date().getFullYear())
                </script> ©, Evara - HTML Ecommerce Template .
            </div>
            <div class="col-sm-6">
                <div class="text-sm-end">
                    All rights reserved
                </div>
            </div>
        </div>
    </footer>
    <!-- JavaScript Imports -->
    <script src="/admin_assets/js/vendors/jquery-3.6.0.min.js"></script>
    <script src="/admin_assets/js/vendors/bootstrap.bundle.min.js"></script>
    <!-- Add more JavaScript imports if needed -->
    <!-- Main Script -->
    <script src="/admin_assets/js/main.js" type="text/javascript"></script>
    <script>
        // Function to highlight clicked sidebar item
        function highlightMenuItem(item) {
            // Remove 'active' class from all menu items
            var menuItems = document.querySelectorAll('.menu-aside .menu-item');
            menuItems.forEach(function(menuItem) {
                menuItem.classList.remove('active');
            });

            // Add 'active' class to the clicked menu item
            item.parentNode.classList.add('active');
        }
    </script>
</body>

</html>
